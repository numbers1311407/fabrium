<%= content_for :body_end do %>
  <%= javascript_include_tag :client %>
<% end %>

<div>
  <div ng-view></div>

  <script type="text/ng-template" id="index.html">
    <form role="form" class="form-search" ng-submit="updateForm()">
      <fieldset>
        <legend>Search Fabrics</legend>
        <div class="form-group">
          <label>Category</label>
          <select 
            selectize="selectize.category"
            ng-model="search.category" 
            class="form-control"
            placeholder="Select..."
          >
            <%= select_options_for_categories %>
          </select>
        </div>

        <div class="form-group form-group-fiber-content">
          <label>Fiber Content</label>
          <select
            selectize="selectize.fiber_content" 
            ng-model="search.fiber_content" 
            class="form-control" 
            placeholder="Select..."
          >
            <%= select_options_for_fiber_content %>
          </select>
        </div>

        <div class="form-group form-group-weights">
          <label>Weight</label>
          <input type="number" ng-model="search.weight_min" class="form-control" placeholder="Any">
          <span>to</span>
          <input type="number" ng-model="search.weight_max" class="form-control" placeholder="Any">
          <select ng-model="search.weight_unit">
            <option value="">GSM</option>
            <option value="glm">GLM</option>
            <option value="osy">OSY</option>
          </select>
        </div>

        <div class="form-group">
          <label>Keywords</label>
          <input selectize="selectize.keywords" type="text" ng-model="search.keywords" class="form-control" placeholder="Type to search...">
        </div>
      </fieldset>

      <fieldset>
        <legend>Advanced Options</legend>
        <div class="form-group form-group-color">
          <label>Color</label>
          <input minicolors ng-model="search.color" class="form-control">
        </div>
      </fieldset>

      <button type="submit" class="btn btn-default">Search</button>
    </form>

    <pagination 
      ng-show="pages > 1"
      items-per-page="perPage" 
      max-size="10" 
      total-items="totalItems" 
      ng-model="search.page"
      ng-change="updateLocation()"
    ></pagination>
    <div ng-if="items.loading">
      Loading...
    </div>
    <ul class="fabric-variant-resultlist" ng-repeat="item in items">
      <li class="fabric-variant-result" style="background-color: #{{ item.color }};">
        <a ng-click="show(item.id)">{{ item.id }}</a>
      </li>
    </ul>
  </script>

  <script type="text/ng-template" id="show.html">
    <div class="modal-header">
      <h3 class="modal-title">Fabric: {{ fabric_variant.id }}</h3>
    </div>
    <div class="modal-body">
      <p>color: #{{ fabric_variant.color }}</p>
    </div>
  </script>
</div>
